<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>电子商务大数据监测平台</title>
	<meta name="renderer" content="webkit" />
	<meta name="force-rendering" content="webkit" />
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
	<script type="text/javascript" src="js/jquery-1.11.0.js"></script>
	<link rel="stylesheet" href="css/common.css" />
	<link rel="stylesheet" href="css/style.css" />
	<link rel="stylesheet" href="css/swiper.min.css" />
</head>
<style>
.swiper-slide-shadow-left , .swiper-slide-shadow-right {
	opacity: 0;
}
</style>

<body style="overflow: hidden;">
	<div class="longNanContainerBox">
		<!--浏览器版本过低>>-->
		<!--<<加载中-->
		<div class="loadsMianBox">
			<div class="loader">
				<span class="text">Loading</span>
				<span class="spinner"></span>
			</div>
		</div>
		<!--<<浏览器版本过低-->
		<div class="browserMainBox">
			<div class="textsMainBox">
				<p class="textsTitles">您的浏览器版本过低，存在安全风险，请升级或下载新版本浏览器<br />（若您使用的是双核浏览器，请采用极速模式）</p>
				<div class="downloadsMainBox">
					<a class="downBtnBox" target="_blank" href="https://www.google.com/intl/zh-CN/chrome/?standalone=1">
						<img src="images/chrome.png"> 立即下载
					</a>
					<a class="downBtnBox" target="_blank"
						href="https://download-ssl.firefox.com.cn/releases-sha2/stub/official/zh-CN/Firefox-latest.exe">
						<img src="images/firefox.png"> 立即下载
					</a>
					<a class="downBtnBox" target="_blank" href="http://down.360safe.com/cse/360cse_9.5.0.138.exe">
						<img src="images/360.png"> 立即下载
					</a>
				</div>
			</div>
		</div>
		<!-- <div class='longNanContainerBox'></div> -->
		<!--加载中>>-->
		<div class="longNan_ContainerBox">
			<div class="title_header_box"></div>
			<p class="titlesTextBox">
				电子商务大数据监测平台
				<i class="right_icon" onclick="rightIconClick()"></i></p>
			<!--<<地图内容块-->
			<div class="longNanMainContentBox">
				<div class="titles">
					<div class="select-box">
						<div class='show_tit' onclick='yearChose()'>
							<span class='show_val'>2019</span>
							<i class='icon_down'></i>
						</div>
						<ul class='chose_year_list'>
						</ul>
					</div>
					<span>年累计电子商务交易额</span>
				</div>
				<p class="smalies"><span id="totalSums" class="counter-value">0.00</span>元</p>
				<span class="switchMaps" onclick="mapSwitch();"></span>
				<span class="quitsMainBtn" onclick="goHome();"></span>
				<p id="mapsName" style="display: none;">产品码全国数据分布统计</p>
				<!--<<地图详细图表-->
				<div id="map-wrap" class="mapsMianBox"></div>
				<!--地图详细图表>>-->
				<!--<<地图轮询图表-->
				<div id="map-wrap2" class="mapsMianBox"></div>
				<!--地图轮询图表>>-->
			</div>
			<!--地图内容块>>-->
			<!--<<电商人才培训-->
			<div class="chartsMainBox_01">
				<p class="contentBlockTitles" onclick="Url('index01')" id='title00'>电商人才培训</p>
				<!--<<图表块--->
				<div id="chaerts01">
				</div>
				<!--图表块>>-->
			</div>
			<!--电商人才培训>>-->
			<!--<<农村产品网络零售商-->
			<div class="chartsMainBox_02">
				<p class="contentBlockTitles" onclick="Url('index02')" id='title01'>农村产品网络零售商</p>
				<!--<<图表块--->
				<div id="chaerts02" class="paddingTop">
					<ul class="retailersMainList" id="retailsListBox">
					</ul>
				</div>
				<!--图表块>>-->
			</div>
			<!--农村产品网络零售商>>-->
			<!--<<扫码归属地查询-->
			<div class="chartsMainBox_03">
				<p class="contentBlockTitles" onclick="Url('index03')" id='title02'>溯源扫码量</p>
				<div id="chaerts03">
				</div>
			</div>
			<!--扫码归属地查询>>-->
			<!--<<网络零售行业分布-->
			<div class="chartsMainBox_06">
				<p class="contentBlockTitles" onclick="Url('index05')" id='title05'>网络零售行业分布</p>
				<div id="chaerts06">
				</div>
			</div>
			<!--网络零售行业分布>>-->
			<!--<<2018年整体交易-->
			<div class="chartsMainBox_07">
				<p class="contentBlockTitles" onclick="Url('index06')" id='title04'>2018年整体交易</p>
				<div id="chaerts07">
					<div class="materialsBox">
						<div class="textsBox">
							<p class="names">服务类</p>
							<p class="moneys"><span id="materialobject" class="counter-value">0.00</span><i>元</i></p>
						</div>
						<div class="watersMain01Box">
							<span><i id="waters01">0</i>%</span>
							<div id="watersmian01" style="width:100%; height: 100%;"></div>
						</div>
					</div>
					<div class="serviceMainBox">
						<div class="textsBox">
							<p class="names">实物类</p>
							<p class="moneys"><span id="serviceClass" class="counter-value">0.00</span><i>元</i></p>
						</div>
						<div class="watersMain02Box">
							<span><i id="waters02">0</i>%</span>
							<div id="watersmian02" style="width:100%; height: 100%;"></div>
						</div>
					</div>
				</div>
			</div>
			<!--2018年整体交易>>-->
			<!--<<网商TOP10-->
			<div class="chartsMainBox_08">
				<p class="contentBlockTitles" onclick="Url('index04')" id='title03'>网商TOP10</p>
				<div id="chaerts08" style="">
					<div class="swiper-container">
						<div class="swiper-wrapper">
							<div class="swiper-slide">
								<ul class="rankingsList" id="networks01">

								</ul>
							</div>
							<div class="swiper-slide swiper-slide02">
								<ul class="rankingsList" id="networks02">

								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!--网商TOP5>>-->
		</div>
		<!-- 提示框 -->
		<div class='el-message'>
			<p class="el-message__content"></p>
		</div>
	</div>
	<!--底部部分>>-->
	<script>
		// 判断 浏览器版/本
		(function (window) {
			var theUA = window.navigator.userAgent.toLowerCase();
			if ((theUA.match(/msie\s\d+/) && theUA.match(/msie\s\d+/)[0]) || (theUA.match(/trident\s?\d+/) && theUA
					.match(/trident\s?\d+/)[0])) {
				var ieVersion = theUA.match(/msie\s\d+/)[0].match(/\d+/)[0] || theUA.match(/trident\s?\d+/)[0];
				if (ieVersion <= 9) {
					// $('.loadsMianBox').hide();
					$(".longNan_ContainerBox").hide();
					$(".browserMainBox").show();
				} else {
					$(".browserMainBox").hide();
					$('.loadsMianBox').show();
					$(".longNan_ContainerBox").show();
				}
			}
		})(window);
	</script>
	<script src="js/echarts.min.js"></script>
	<script src="js/echarts-liquidfill.js"></script>
	<script src="js/china.js"></script>
	<script src="js/resize.js"></script>
	<script src="js/citymap.js"></script>
	<script src="js/swiper.jquery.min.js"></script>
<!-- 	<script src="js/swiper.min.js"></script> -->
	<script>
		window.onload = function () {
			$('.el-message').hide();
			var token = window.location.search
			adminToken = token.substr(1);

			// 获取当前年份
			var date = new Date;
			var year = date.getFullYear();
			$('.show_val').html(year)
			const year02 = Number(year) - 2;
			const year01 = Number(year) - 1;
			const yearOption = '<li class="year_option" onclick="choseYear(' + year + ')">' + year +
				'</li><li class="year_option" onclick="choseYear(' + year01 + ')">' + year01 +
				'</li><li class="year_option" onclick="choseYear(' + year02 + ')">' + year02 + '</li>'
			$('.chose_year_list').html(yearOption);
			$(".longNan_ContainerBox").show();
			// 获取6个标题
			getSixTitle(year);
			// 字体自适应
			longNanContainer(year);

		}
		var endtime =0;
		var dataV1, dataV2, dataV3, dataV4, dataV5, dataV6, dataMap, dataSl;
		// var baseUrl = "https://" + document.domain + '/';
		var baseUrl = "https://lnsybak.bluearp.com/";
		//跳转
		function Url(url) {
			var year = $('.show_val').text();
			window.location.href = "./html/" + url + ".html?token=" + adminToken + "&year=" + year;
		}

		function rightIconClick() {
			window.location.href = "index2.html?" + adminToken
		}

		function goHome() {
			$('.el-message').removeClass('el-message--success', 'el-message--error')
			//  退出登录/
			$.post(baseUrl + 'public/loginout', {
					'api_token': adminToken,
					'type' : 3
				},
				function (data) {
					if (data.code === 200) {
						$('.el-message').addClass('el-message--success')
						$('.el-message__content').html(data.data).show().delay(2000).fadeOut();
						window.location.href = baseUrl + '#/'
					} else {
						$('.el-message').addClass('el-message--error')
						$('.el-message__content').html(data.data).show().delay(2000).fadeOut();
					}
				}
			)
		}
		// 选择年份
		function yearChose() {
			if(endtime===1){
				$('.chose_year_list').show()
			}
		}

		function choseYear(value) {
			$('.show_val').html(value)
			$('.chose_year_list').hide()

			longNanContainer();
			//人才数量接口
			personnels(value);
			//其他各项数据接口
			masterdatas(value);
			//扫码量
			regions(value);
		}

		//字体适配屏占比控制
		function longNanContainer() {
			var heights = $(window).height();
			var widths = $(window).width();
			var ratios = heights / widths;
			if (ratios <= 0.35) {
				$('.longNanContainerBox').css({
					'width': widths,
					'height': widths * 0.35,
				});
				$('body').css({
					'overflow': 'auto',
				})

			} else {
				$('.longNanContainerBox').css({
					'width': widths,
					'height': heights,
				});
				$('body').css({
					'overflow': 'hidden',
				})
			}

			var sizes = widths / 1920 * 100;
			$('html').css("font-size", sizes);
			setTimeout("longNanContainer()", 1);
		}
		// 获取6大标题
		function getSixTitle(year) {
			$('.el-message').removeClass('el-message--success', 'el-message--error')
			$.post(baseUrl + 'public/Bigdata/title', {
					'api_token': adminToken,
				},
				function (data) {
					$(".loadsMianBox").hide();
					if (data.code === 200) {
						const dataTit = data.data
						for (let i in dataTit) {
							$('#title0' + i).html(dataTit[i].pub_name)
						}
						// 获取当前年份
						var date = new Date;
						var year = date.getFullYear();
						//人才数量接口
						personnels(year);
						//其他各项数据接口
						masterdatas(year);
						//扫码量
						regions(year);
					} else if (data.code === 500) {
						window.location.href = baseUrl + '#/'
					} else {
						window.location.href = baseUrl + '#/'
					}
				})
		}

		//页面数据主接口
		function masterdatas(yearDate) {
			$('.el-message').removeClass('el-message--success', 'el-message--error')
			$.post(baseUrl + 'public/Bigdata/getsales', {
					'api_token': adminToken,
					'year': yearDate
				},
				function (data) {
					if (data.code === 200) {
						dataV6 = data.data.classa; //网络零售行业分布
						dataMap = data.data;
						dataV2 = data.data.goods; //农产品排行
						dataSl = data.data.sales; //总金额
						dataV5 = data.data.cla; //实物与服务
						dataV4 = data.data.com; //网商top10
						// $('#chaerts06').html('')
						const data01 = eval("(" + data.data.classa + ")");
						if (data01.length === 0) {
							$('#chaerts06').html('<span class="nodataText">暂无数据</span>');
							document.getElementById('chaerts06').setAttribute('_echarts_instance_', '')
						} else {
							industrys(data.data.classa);
						}
						mapsDataBox(data.data)
						retails(data.data.goods);
						totalsumMainBox(data.data.sales);
						categoryMainBox(data.data.cla);
						networks(data.data.com)
						
					} else if (data.code === 500) {
						$('.el-message').addClass('el-message--error')
						$('.el-message__content').html(data.data).show.delay(2000).fadeOut();
					} else {
						window.location.href = baseUrl + '#/'
					}
				})
		}
		//人才培训
		function personnels(yearDate) {
			$.post(baseUrl + 'public/Bigdata/getpersonnel', {
					'api_token': adminToken,
					'year': yearDate
				},
				function (data) {
					if (data.code === 200) {
						dataV1 = data.data
						// $('#chaerts01').html('');
						const data01 = eval("("   + data.data.time.data +  ")");
						
						if (data01.length === 0) {
							$('#chaerts01').html('<span class="nodataText">暂无数据</span>');
							document.getElementById('chaerts01').setAttribute('_echarts_instance_', '')
						} else {	
							trainsBox(data.data)
						}

					} else {
						window.location.href = baseUrl + '#/'
					}
				})

		}
		//溯源二维码发码量接口
		function regions(yearDate) {
			$.post(baseUrl + 'public/Bigdata/Getsweep', {
					'api_token': adminToken,
					'year': yearDate
				},
				function (data) {
					if (data.code === 200) {
						dataV3 = data.data
						regionsCode(data.data)
					} else {
						window.location.href = baseUrl + '#/'
					}
				})

		}
		//农产品排行
		function retails(text) {
			$('#retailsListBox').html('')
			if (text === '') {
				$('#retailsListBox').html('')
				$('#retailsListBox').html('<span class="nodataText">暂无数据</span>')
			} else {
				var moneys = 0;
				for (var i = 0; i < text.length; i++) {
					moneys += Number(text[i].value);
				}
				for (var i = 0; i < text.length; i++) {
					var propor = (text[i].value / moneys * 100).toFixed(2) + '%';
					$('#retailsListBox').append("<li><span class='names' title='" + text[i].name + "'>" + text[i].name +
						"</span><p><span style='width:" + propor + "'></span></p><span class='moneys counter-value' title='" +
						text[i].value + "'>" + text[i].value + "</span></li>")
				}
			}
		}
		var mySwiper = new Swiper('.swiper-container', {
			autoplay: 5000,
			speed: 500,
			effect: 'flip',
			observeParents: true,
			autoplayDisableOnInteraction: false,
		});
		//网商TOP10
		function networks(text) {
			$('#networks01').html('')
			$('#networks02').html('')
			if (text === '') {
				$('#networks01').html('<span class="nodataText">暂无数据</span>')
			} else {
				for (var i = 0; i < text.length; i++) {
					var ranking = i + 1;
					if (i <= 4) {
						$('#networks01').append("<li>" + ranking +
							"<span title='" + text[i] + "'>" + text[i] + "</span></li>")
					} else {
						$('#networks02').append("<li>" + ranking +
							"<span title='" + text[i] + "'>" + text[i] + "</span></li>")
					}
				}

				if (text.length < 6) {
					$('.swiper-slide02').hide()
					// mySwiper.update(false);
					mySwiper.update(false);

				} else {
					mySwiper.update(true);
				}
				$(".loadsMianBox").hide();
				textsroll();
			}
		}


		var totalsunm =0.0
		//总金额获取
		function totalsumMainBox(texts) {
			// $("#totalSums").empty();
			// totalsunm = Number(texts)
			if (totalsunm != texts) {
				totalsunm = texts;
				texts=Number(texts)
				$('#totalSums').html(texts);
			}
				// totalsunm= 0.00;
				// $("#totalSums").append(texts
				// endtime  =1
				// return 0
			// }
			
		}
		//实物与服务
		function categoryMainBox(texts) {
			var arr = []
			for (let i in texts) {
				arr.push(texts[i]);
			}
			console.log(arr.length,'11')
			if (arr.length == 1) {
				$('#materialobject').html(arr[0]);
				var materiaNum = eval("(" + "[" + arr[0] / totals + "]" + ")");
				var munsone = arr[0] / totals * 100;
				$('#waters01').html(munsone.toFixed(1));
				watesopts01(materiaNum);
			} else if (arr.length = 0) {
				arr = [0, 0];
				$('#materialobject').html(arr[0]);
				$('#serviceClass').html(arr[1]);
				var totals = arr[0] + arr[1];
				var materiaNum = eval("(" + "[" + arr[0] / totals + "]" + ")");
				var serviceNum = eval("(" + "[" + arr[1] / totals + "]" + ")");
				var munsone = arr[0] / totals * 100;
				var munstwo = arr[1] / totals * 100;
				$('#waters01').html(munsone.toFixed(1));
				$('#waters02').html(munstwo.toFixed(1));
				watesopts01(materiaNum);
				watesopts02(serviceNum);
			} else {
				var arr = []
				for (let i in texts) {
					arr.push(Number(texts[i]));
				}

				$('#materialobject').html(arr[0]);
				$('#serviceClass').html(arr[1]);

				var totals = arr[0] + arr[1];
				if (totals === 0) {
					watesopts01([0]);
					watesopts02([0]);
					$('#waters01').html('0.00');
					$('#waters02').html('0.00');
				} else {
					var materiaNum = eval("(" + "[" + arr[0] / totals + "]" + ")");
					var serviceNum = eval("(" + "[" + arr[1] / totals + "]" + ")");
					var munsone = arr[0] / totals * 100;
					var munstwo = arr[1] / totals * 100;
					/*$('#waters01').html(munsone.toFixed(1));
					$('#waters02').html(munstwo.toFixed(1));*/
					if(munsone.toFixed(1)==='0.0' && arr[0]!==0){
						watesopts01([0.1]);
						watesopts02([99.9]);
						$('#waters01').html('0.1');
						$('#waters02').html('99.9');
					}else{
						watesopts01(materiaNum);
						watesopts02(serviceNum);
						$('#waters01').html(munsone.toFixed(1));
						$('#waters02').html(munstwo.toFixed(1));
					}
				}

			}


		}

		//水球图例1
		var wates01 = echarts.init(document.getElementById('watersmian01'));

		function watesopts01(materiaNum) {
			var watesoption01 = {
				series: [{
					type: 'liquidFill',
					data: materiaNum,
					radius: '80%',
					// 水球颜色
					color: ['#ffcc00'],
					center: ['50%', '50%'],
					outline: {
						show: false
					},
					label: {
						formatter: function () {
							return '';
						},
					},
					// 内图 背景色 边
					backgroundStyle: {
						color: 'rgba(4,24,74,0)',
						borderWidth: 2,
						borderColor: '#ffcc00',
					}
				}]
			};
			// 使用刚指定的配置项和数据显示图表。
			wates01.setOption(watesoption01);
			wates01.resize()

		}

		//水球图例2
		var wates02 = echarts.init(document.getElementById('watersmian02'));

		function watesopts02(serviceNum) {
			var watesoption02 = {
				series: [{
					type: 'liquidFill',
					data: serviceNum,
					radius: '80%',
					// 水球颜色
					color: ['#ff6d00'],
					center: ['45%', '50%'],
					outline: {
						show: false
					},
					label: {
						formatter: function () {
							return '';
						},
					},
					// 内图 背景色 边
					backgroundStyle: {
						color: 'rgba(4,24,74,0)',
						borderWidth: 2,
						borderColor: '#ff6d00',
					}
				}]
			};
			// 使用刚指定的配置项和数据显示图表。
			wates02.setOption(watesoption02);
			wates02.resize();
		}

		//文字改变滚动效果
		function textsroll() {
			// window.setInterval(textsroll(), 3000)
			//价格效果\
			endtime=0
			$('.counter-value').each(function () {
				$(this).prop('Counter', 0).animate({
					Counter: $(this).text()
				}, {
					duration: 3500,
					easing: 'swing',
					step: function (now) {
						var nows = parseFloat(now.toFixed(2))
						$(this).text(nows.toLocaleString());
						// endtime=1
					}
				});
				
			});
			setTimeout(function (){
				 endtime=1
			},3500)

		}
		// 下跳地图
		var chart = echarts.init(document.getElementById('map-wrap'));
		// 轮询地图
		var mapChart = echarts.init(document.getElementById('map-wrap2'));

		//地图数据插入
		function mapsDataBox(text) {
			text.shengstr = eval("(" + text.shengstr + ")");
			text.shenglagstr = eval("(" + text.shenglagstr + ")");
			text.citystr = eval("(" + text.citystr + ")");
			//34个省、市、自治区的名字拼音映射数组
			var provinces = {
				//23个省
				"台湾": "taiwan",
				"河北": "hebei",
				"山西": "shanxi",
				"辽宁": "liaoning",
				"吉林": "jilin",
				"黑龙江": "heilongjiang",
				"江苏": "jiangsu",
				"浙江": "zhejiang",
				"安徽": "anhui",
				"福建": "fujian",
				"江西": "jiangxi",
				"山东": "shandong",
				"河南": "henan",
				"湖北": "hubei",
				"湖南": "hunan",
				"广东": "guangdong",
				"海南": "hainan",
				"四川": "sichuan",
				"贵州": "guizhou",
				"云南": "yunnan",
				"陕西": "shanxi1",
				"甘肃": "gansu",
				"青海": "qinghai",
				//5个自治区
				"新疆": "xinjiang",
				"广西": "guangxi",
				"内蒙古": "neimenggu",
				"宁夏": "ningxia",
				"西藏": "xizang",
				//4个直辖市
				"北京": "beijing",
				"天津": "tianjin",
				"上海": "shanghai",
				"重庆": "chongqing",
				//2个特别行政区
				"香港": "xianggang",
				"澳门": "aomen"
			};

			//直辖市和特别行政区-只有二级地图，没有三级地图
			var special = ["北京", "天津", "上海", "重庆", "香港", "澳门"];
			var mapdata = [];
			var data = text.citystr;
			//绘制全国地图
			$.getJSON('map/china.json', function (data) {
				d = [];
				for (var i = 0; i < data.features.length; i++) {
					d.push({
						name: data.features[i].properties.name
					})
				}
				mapdata = d;
				//注册地图
				echarts.registerMap('china', data);
				//绘制地图
				renderMap('china', d);
			});

			//地图点击事件
			chart.on('click', function (params) {
				if (params.name in provinces) {
					//如果点击的是34个省、市、自治区，绘制选中地区的二级地图
					$.getJSON('map/province/' + provinces[params.name] + '.json', function (data) {
						echarts.registerMap(params.name, data);
						var d = [];
						for (var i = 0; i < data.features.length; i++) {
							d.push({
								name: data.features[i].properties.name
							})
						}
						renderMap(params.name, d);
					});
				} else if (params.seriesName in provinces) {
					//如果是【直辖市/特别行政区】只有二级下钻
					if (special.indexOf(params.seriesName) >= 0) {
						renderMap('china', mapdata);
					} else {
						//显示县级地图
						if (cityMap[params.name]) {
							$.getJSON('map/city/' + cityMap[params.name] + '.json', function (data) {
								echarts.registerMap(params.name, data);
								var d = [];
								for (var i = 0; i < data.features.length; i++) {
									d.push({
										name: data.features[i].properties.name
									})
								}
								renderMap(params.name, d);
							});
						} else {
							renderMap('china', mapdata);
						}

					}
				} else {
					renderMap('china', mapdata);
				}
			});

			//初始化绘制全国地图配置
			var option = {
				title: {
					show: false,
				},
				tooltip: {
					trigger: 'item',
					show: true,
					formatter: function (params) {
						for (var i = 0; i < data.length; i++) {
							if (data[i].name == params.data.name) {
								return "<span style='color: #ffff33;border-bottom: 1px solid #ffff33;font-size:14px;display: block;'>" +
									params.data.name + "</span>销售金额 : " + data[i].value[0];
							}
						}
					}

				},
				animationDuration: 1000,
				animationEasing: 'cubicOut',
				animationDurationUpdate: 1000

			};

			function renderMap(map, data) {
				option.title.subtext = map;
				option.series = [{
					name: map,
					type: 'map',
					mapType: map,
					roam: false,
					label: {
						normal: {
							show: true,
							align: 'center',
							verticalAlign: 'middle',
							textStyle: {
								color: '#ffffff',
								fontSize: 14
							}
						},
						emphasis: {
							show: true,
							align: 'center',
							verticalAlign: 'middle',
							textStyle: {
								color: '#ffffff',
								fontSize: 14
							},

						}
					},
					itemStyle: {
						normal: {
							areaColor: '#1d92c9',
							borderColor: '#d9e3e4'
						},
						emphasis: {
							areaColor: '#50bcee',
							borderColor: '#d9e3e4'
						}
					},
					data: data
				}];
				//渲染地图
				chart.setOption(option);
			}

			// 例如海门9是发码量，10是扫码量
			var databor = text.shengstr;
			//经纬度   前经度后纬度
			var geoCoordMap = text.shenglagstr;

			var convertData = function (databor) {
				var res = [];
				for (var i = 0; i < databor.length; i++) {
					var geoCoord = geoCoordMap[databor[i].name];
					if (geoCoord) {
						res.push({
							name: databor[i].name,
							value: geoCoord.concat(databor[i].value)
						});
					}
				}
				return res;
			};
			mapChart.setOption(options = {
				tooltip: {
					show: true,
					triggerOn: "none",
					formatter: function (params) {
						for (var i = 0; i < options.series[0].data.length; i++) {
							if (options.series[0].data[i].name == params.data.name) {
								return "<span style='color: #ffff33;font-size:14px;display: block;'>" +
									params.data.name + "</span>";
							}
						}

					}

				},
				geo: {
					map: 'china',
					show: true,
					roam: false,
					label: {
						normal: {
							show: true,
							fontSize: 14,
							align: 'center',
							color: "#ffffff",
						},
						emphasis: {
							show: true,
							fontSize: 14,
							align: 'center',
							color: "#ffffff",
						}
					},
					itemStyle: { // 定义样式
						normal: {
							areaColor: '#1d92c9',
							borderColor: '#d9e3e4'
						},
						emphasis: {
							areaColor: '#1d92c9',
							borderColor: '#d9e3e4'
						}

					},
				},
				series: [{
					type: 'effectScatter',
					coordinateSystem: 'geo',
					data: convertData(databor),
					showEffectOn: 'render',
					rippleEffect: {
						brushType: 'stroke'
					},
					hoverAnimation: true,
					label: {
						normal: {
							show: false
						}
					},
					itemStyle: {
						normal: {
							color: '#ffff33',
							shadowBlur: 10,
							shadowColor: '#333'
						}
					},
					zlevel: 1
				}]
			});
			//当数据刷新的时候再次调取   mapChart.setOption(option,true)表示数据更新，mapChart.setOption(option,false)表示合并新数据原数据存在
			mapChart.setOption(options);
			mapChart.resize();
			//地图自动轮询
			var index = 0; //播放所在下标
			var timers = setInterval(function () {
				mapChart.dispatchAction({
					type: 'showTip',
					seriesIndex: 0,
					dataIndex: index
				});
				index++;
				if (index > databor.length) {
					index = 0;
				}
			}, 2000);
		}

		var chartSmail01

		function trainsBox(texts) {
			console.log(texts,'tewxts')
			chartSmail01 = echarts.init(document.getElementById('chaerts01'))
			texts.time.data = eval("(" + texts.time.data + ")");
			texts.time.value = eval("(" + texts.time.value + ")");
			console.log(texts.time.data)
			console.log(texts.time.value,'vla')
			//电商人才培训
			optionmain01 = {
				noDataLoadingOption: {
					text: '暂无数据',
					effect: 'bubble',
					effectOption: {
						effect: {
							n: 0
						}
					}
				},
				color: ['#00eaf9'],
				tooltip: {
					trigger: 'axis',
					axisPointer: { // 坐标轴指示器，坐标轴触发有效
						type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'
					}
				},
				grid: {
					left: '3%',
					right: '4%',
					bottom: '3%',
					top: '25%',
					containLabel: true
				},
				xAxis: [{
					type: 'category',
					data: texts.time.data,
					axisLine: {
						lineStyle: {
							color: '#ffffff',
						}
					},
					axisTick: {
						alignWithLabel: true,
						lineStyle: {
							color: '#ffffff',
						}
					},
					nameTextStyle: {
						color: '#ffffff',
					},
					splitLine: {
						show: false
					}
				}],
				yAxis: [{
					type: 'value',
					axisLine: {
						lineStyle: {
							color: '#ffffff',
						}
					},
					axisTick: {
						alignWithLabel: true,
						lineStyle: {
							color: '#ffffff',
						}
					},
					nameTextStyle: {
						color: '#ffffff',
					},
					splitLine: {
						show: false
					}

				}],
				series: [{
					name: '培训数量',
					type: 'bar',
					barWidth: '20%',
					data: texts.time.value
				}]
			};

			chartSmail01.setOption(optionmain01);
			chartSmail01.resize()
			//人才培训轮询
			var index01 = 0; //播放所在下标
			var timers01 = setInterval(function () {
				chartSmail01.dispatchAction({
					type: 'showTip',
					seriesIndex: 0,
					dataIndex: index01
				});
				index01++;
				if (index01 > texts.time.data.length) {
					index01 = 0;
				}
			}, 2000);

		}
		//扫码城市
		var chartSmail03 = echarts.init(document.getElementById('chaerts03'));

		function regionsCode(data) {
			const dataMonth = [],
				valueData = []
			for (let i in data) {
				dataMonth.push(i + '月');
				valueData.push(data[i])
			}
			optionmain03 = {
				color: ['#00eaf9'],
				tooltip: {
					trigger: 'axis',
					axisPointer: { // 坐标轴指示器，坐标轴触发有效
						type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'
					}
				},
				grid: {
					left: '3%',
					right: '4%',
					bottom: '3%',
					top: '25%',
					containLabel: true
				},
				xAxis: [{
					type: 'category',
					data: dataMonth,
					axisLine: {
						lineStyle: {
							color: '#ffffff',
						}
					},
					axisTick: {
						alignWithLabel: true,
						lineStyle: {
							color: '#ffffff',
						}
					},
					nameTextStyle: {
						color: '#ffffff',
					},
					splitLine: {
						show: false
					}
				}],
				yAxis: [{
					type: 'value',
					axisLine: {
						lineStyle: {
							color: '#ffffff',
						}
					},
					axisTick: {
						alignWithLabel: true,
						lineStyle: {
							color: '#ffffff',
						}
					},
					nameTextStyle: {
						color: '#ffffff',
					},
					splitLine: {
						show: false
					}

				}],
				series: [{
					name: '发码量',
					type: 'line',
					barWidth: '60%',
					data: valueData
				}]
			};

			chartSmail03.setOption(optionmain03);
			chartSmail03.resize();
			//扫码溯源量
			var index0_3 = 0; //播放所在下标
			var timers03 = setInterval(function () {
				chartSmail03.dispatchAction({
					type: 'showTip',
					seriesIndex: 0,
					dataIndex: index0_3
				});
				index0_3++;
				if (index0_3 > dataMonth.length) {
					index03 = 0;
				}
			}, 2000);

		}

		//零售行业分布
		var chartSmail06

		function industrys(text) {
			chartSmail06 = echarts.init(document.getElementById('chaerts06'))
			texts = eval("(" + text + ")");
			//				var names =getObjectKeys(text);
			//				var values =getObjectValues(text);
			// 
			// if (texts.length === 0) {
			// 	// $("#chaerts06").html('<span class="nodataText">暂无数据</span>')
			// 	return false
			// }
			optionmain06 = {
				tooltip: {
					trigger: 'item',
					// formatter: "{b} <br/> {c} ({d}%)"
					 formatter:function(data){
					 	
                        var perc=data.percent.toFixed(1)
                      if(data.percent.toFixed(1)==='0.0'){
                        perc='0.1'
                      }
                      return data.seriesName + "<br/>"+ data.name+ " : " + data.value + " ("+perc+"%)";    
                    }
				},
				color: ['#00edfc', '#ffcc00', '#01f1cc', '#fe7678', '#ff6d00'],
				series: [{
					name:'',
					type: 'pie',
					radius: '65%',
					center: ['50%', '55%'],
					data: texts.sort(function (a, b) {
						return a.value - b.value;
					}),
					label: {
						normal: {
							textStyle: {
								color: '#ffffff'
							}
						}
					},
					labelLine: {
						normal: {
							lineStyle: {
								color: '#ffffff'
							},
							smooth: 0.2,
							length: 10,
							length2: 20
						}
					},
				}]
			};

			chartSmail06.setOption(optionmain06);
			chartSmail06.resize();

			//行业分布轮询
			var index06 = 0; //播放所在下标
			var timers06 = setInterval(function () {
				chartSmail06.dispatchAction({
					type: 'showTip',
					seriesIndex: 0,
					dataIndex: index06
				});
				index06++;
				if (index06 > texts.length) {
					index06 = 0;
				}
			}, 2000);

		}

		//适配加载图表
		$(".longNanContainerBox").resize(function () {
			mapsDataBox(dataMap)
			retails(dataV2);
			totalsumMainBox(dataSl);
			categoryMainBox(dataV5);
			networks(dataV4);
			trainsBox(dataV1);
			regionsCode(dataV3)
			industrys(dataV6);
		});

		function mapSwitch() {

			if ($('#mapsName').html() == '产品码全国数据分布统计') {
				$('#mapsName').html('产品码城市数据统计');
				$('#map-wrap2').hide();
				$('#map-wrap').show();

			} else {
				$('#mapsName').html('产品码全国数据分布统计');
				$('#map-wrap').hide();
				$('#map-wrap2').show();

			}
			chart.resize();
			mapChart.resize();

		}
		//
		//			function getObjectKeys(object) {
		//				let keys = []
		//				for(let property in object){
		//					keys.push(property)
		//				} 
		//				return keys
		//			}
		//
		//			function getObjectValues(object) {
		//				let values = []
		//				for(let property in object){
		//					values.push(object[property])
		//				}
		//				return values
		//			}
	</script>
</body>

</html>